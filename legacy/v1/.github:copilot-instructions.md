# Zen Ops Copilot Instructions (Repo-Wide)

## Non-negotiables
- NEVER run `docker compose down -v` in production docs/scripts.
- DB must live in a named volume and must never be recreated by deploy scripts.
- Use versioned image tags (git SHA), never `latest`.
- Deploy flow must be: pull → backup → migrate → up → healthcheck → smoke test.
- Use expand→deploy→contract mindset for DB migrations (no breaking changes).

## Coding style
- Prefer small, readable bash scripts with strict mode (`set -euo pipefail`).
- Add comments for any destructive/irreversible operations.
- Add explicit “are you sure?” guardrails where appropriate.
- Output copy-paste commands and a runbook markdown.

## Expected deliverables when asked for deployment protocol
- ops/deploy.sh
- ops/backup.sh
- ops/restore.sh (documented; even if not fully automated)
- docker-compose.prod.yml (or prod overlay)
- systemd timer OR host cron (choose simplest safe default)
- docs/DEPLOYMENT_RUNBOOK.md