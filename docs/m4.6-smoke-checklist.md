# M4.6 Smoke Checklist

## Prerequisites
- API reachable at `API_BASE_URL` (default `http://127.0.0.1:3000/v1`)
- DB bootstrapped (`pnpm bootstrap:db`)
- Seed users present (`3333...` internal admin, `4444...` studio admin)

## Scripted smoke
- Run:
  - `./scripts/demo-m4.6.sh`
- Expect:
  - `PASS`
  - non-empty IDs for:
    - `bank_id`
    - `branch_id`
    - `channel_id`
    - `assignment_id`
    - `task_id`
    - `channel_request_id`
    - `accepted_assignment_id`

## Manual API spot checks
1. Assignment lifecycle history
- `GET /v1/assignments/{assignment_id}/status-history`
- Expect at least one row with `to_status=COLLECTING`.

2. Tasks queue behavior
- `GET /v1/tasks?assignment_id={assignment_id}`
- Expect created task visible and `status=DONE` after mark-done step.

3. Channel request review
- `GET /v1/channel-requests`
- Expect accepted request visible with non-null `assignment_id`.

4. Analytics fallback
- `GET /v1/analytics/overview`
- Expect numeric counters with no 500 for empty datasets.

## Manual UI checks
1. Web Workspace
- Open Assignments list and confirm lifecycle badges + source labels are shown.
- Open assignment detail and verify status transition control + status timeline render.
- Open Analytics page and verify Retry works and fallback state renders safely.

2. Portal
- Submit one Channel Request and verify it appears in "My Requests".

3. Studio
- Review channel requests and accept/reject path returns success.

## Regression checks
- `pnpm contract_check`
- `pnpm test`
- Ensure `apps/api/openapi.json` is regenerated and committed with endpoint changes.
